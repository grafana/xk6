$id: https://grafana.github.io/xk6/compliance.schema.json
$ref: "#/$defs/compliance"
$defs:
  compliance:
    description: |
      The result of the extension's k6 compliance checks.
    type: object
    required:
      - passed
      - timestamp
    properties:
      passed:
        description: |
          The result of the check.

          A true value of the passed property indicates a successful check, while a false value indicates a failure.
        type: boolean
      timestamp:
        description: |
          Compliance check timestamp.

          The timestamp property contains the start timestamp of the check in Unix time format (the number of non-leap seconds that have elapsed since 00:00:00 UTC on 1st January 1970).
        type: number
        default: 0
      checks:
        description: |
          Results of individual checks.
        type: array
        items:
          $ref: "#/$defs/check"
      preset:
        description: |
          The preset used for the compliance check.
        $ref: "#/$defs/preset_definition"
    additionalProperties: false
  check:
    description: |
      The result of a particular inspection.
    type: object
    additionalProperties: false
    required:
      - id
      - passed
    properties:
      id:
        description: |
          The ID of the check.

          It identifies the method of check, not the execution of the check.
        $ref: "#/$defs/check_id"
      passed:
        description: |
          The result of the check.

          A true value of the passed property indicates a successful check, while a false value indicates a failure.
        type: boolean
      details:
        description: |
          Textual explanation of the check result.
        type: string
        default: ""
      definition:
        description: |
          The definition of the check that was performed.
        $ref: "#/$defs/check_definition"
  check_id:
    description: |
      The ID of the check.

      It identifies the method of check, not the execution of the check.
    type: string
    enum:
      - module
      - security
      - vulnerability
      - replace
      - readme
      - examples
      - license
      - git
      - versions
      - build
      - smoke
      - codeowners
      - types
  check_definition:
    description: |
      The definition of a particular inspection.
    type: object
    additionalProperties: false
    required:
      - id
      - description
      - rationale
      - resolution
    properties:
      id:
        description: |
          The ID of the check.

          It identifies the method of check, not the execution of the check.
        $ref: "#/$defs/check_id"
      description:
        description: |
          A brief description of what the check inspects.
        type: string
      rationale:
        description: |
          An explanation of why the check is important.
        type: string
      resolution:
        description: |
          Guidance on how to resolve a failed check.
        type: string
  preset_definition:
    description: |
      The definition of a preset.
    type: object
    additionalProperties: false
    required:
      - id
      - description
      - checks
    properties:
      id:
        description: |
          The ID of the preset.
        $ref: "#/$defs/preset_id"
      description:
        description: |
          A brief description of what the preset represents.
        type: string
      checks:
        description: |
          The list of checks that are part of this preset.
        type: array
        items:
          $ref: "#/$defs/check_id"
  preset_id:
    description: |
      The ID of the preset.

      It identifies the preset used for the compliance check.
    type: string
    enum:
      - all
      - loose
      - strict
      - private
      - community
      - official
